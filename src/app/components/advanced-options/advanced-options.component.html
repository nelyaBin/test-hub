<!-- src/app/components/advanced-options/advanced-options.component.html -->
<div class="config-card">
  <button
    class="advanced-toggle"
    (click)="toggleAdvanced()"
    type="button"
  >
    <span class="toggle-icon" [class.open]="showAdvanced()">▼</span>
    <span>Advanced Options</span>
  </button>

  @if (showAdvanced()) {
    <div class="advanced-content">
      <!-- Headers -->
      <div class="input-group">
        <label class="input-label">Headers</label>
        <div class="key-value-list">
          @for (header of headers(); track $index) {
            <div class="key-value-row">
              <input
                type="text"
                class="config-input key-input"
                placeholder="Key"
                [value]="header.key"
                (input)="updateHeaderKey($index, $any($event.target).value)"
              />
              <input
                type="text"
                class="config-input value-input"
                placeholder="Value"
                [value]="header.value"
                (input)="updateHeaderValue($index, $any($event.target).value)"
              />
              <button
                class="remove-btn"
                type="button"
                (click)="removeHeader($index)"
                [disabled]="headers().length === 1"
              >
                ✕
              </button>
            </div>
          }
          <button class="add-btn" type="button" (click)="addHeader()">
            + Add Header
          </button>
        </div>
      </div>

      <!-- Thresholds -->
      <div class="input-group">
        <label class="input-label">Thresholds</label>
        <div class="key-value-list">
          @for (threshold of thresholds(); track $index) {
            <div class="key-value-row">
              <input
                type="text"
                class="config-input key-input"
                placeholder="Metric (e.g., p95)"
                [value]="threshold.metric"
                (input)="updateThresholdMetric($index, $any($event.target).value)"
              />
              <input
                type="text"
                class="config-input value-input"
                placeholder="Condition (e.g., < 500ms)"
                [value]="threshold.condition"
                (input)="updateThresholdCondition($index, $any($event.target).value)"
              />
              <button
                class="remove-btn"
                type="button"
                (click)="removeThreshold($index)"
                [disabled]="thresholds().length === 1"
              >
                ✕
              </button>
            </div>
          }
          <button class="add-btn" type="button" (click)="addThreshold()">
            + Add Threshold
          </button>
        </div>
      </div>

      <!-- Environment Variables -->
      <div class="input-group">
        <label class="input-label">Environment Variables</label>
        <div class="key-value-list">
          @for (envVar of environmentVariables(); track $index) {
            <div class="key-value-row">
              <input
                type="text"
                class="config-input key-input"
                placeholder="Key"
                [value]="envVar.key"
                (input)="updateEnvVarKey($index, $any($event.target).value)"
              />
              <input
                type="text"
                class="config-input value-input"
                placeholder="Value"
                [value]="envVar.value"
                (input)="updateEnvVarValue($index, $any($event.target).value)"
              />
              <button
                class="remove-btn"
                type="button"
                (click)="removeEnvironmentVariable($index)"
                [disabled]="environmentVariables().length === 1"
              >
                ✕
              </button>
            </div>
          }
          <button
            class="add-btn"
            type="button"
            (click)="addEnvironmentVariable()"
          >
            + Add Environment Variable
          </button>
        </div>
      </div>
    </div>
  }
</div>